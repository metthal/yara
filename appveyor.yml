# AppVeyor CI for Windows

version: 3.9.0-{build}

pull_requests:
  do_not_increment_build_number: true

environment:
  matrix:
  - TARGET: vs2015
    APPVEYOR_BUILD_WORKER_IMAGE: Visual Studio 2015
    CMAKE_GENERATOR: Visual Studio 14 2015
    configuration: Release
    platform: x86
  - TARGET: vs2015
    APPVEYOR_BUILD_WORKER_IMAGE: Visual Studio 2015
    CMAKE_GENERATOR: Visual Studio 14 2015
    configuration: Debug
    platform: x86
  - TARGET: vs2015
    APPVEYOR_BUILD_WORKER_IMAGE: Visual Studio 2015
    CMAKE_GENERATOR: Visual Studio 14 2015 Win64
    platform: x64
    configuration: Release
  - TARGET: vs2015
    APPVEYOR_BUILD_WORKER_IMAGE: Visual Studio 2015
    CMAKE_GENERATOR: Visual Studio 14 2015 Win64
    platform: x64
    configuration: Debug
  - TARGET: cygwin
    CMAKE_GENERATOR: Unix Makefiles

install:
  - choco install -Y winflexbison3

build_script:
  - mkdir build
  - cd build
  - cmake -G"%CMAKE_GENERATOR%" -DCMAKE_BUILD_TYPE=Release ..
  - cmake --build . --config %configuration% -- -m

test_script:
  - ctest -V

# Uncomment the lines below for enabling Remote Desktop in the Appveyor. This
# allows connecting to the remote machine and debug issues.
# on_finish:
# - ps: $blockRdp = $true; iex ((new-object net.webclient).DownloadString('https://raw.githubusercontent.com/appveyor/ci/master/scripts/enable-rdp.ps1'))
